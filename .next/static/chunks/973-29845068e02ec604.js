"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[973],{8310:function(e,t,n){n.d(t,{Yj:function(){return s},ZP:function(){return r},i_:function(){return c}});var i=n(7437),a=n(29),o=n.n(a);function r(e){let{isOpen:t,onClose:n,onConfirm:a,title:r,message:s,confirmText:c="Confirm",cancelText:l="Cancel",type:d="warning",isLoading:m=!1}=e;if(!t)return null;let b=()=>{switch(d){case"success":return"#28a745";case"warning":default:return"#ffc107";case"info":return"#17a2b8"}};return(0,i.jsxs)("div",{onClick:n,className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-overlay",children:[(0,i.jsx)(o(),{id:"2f014c33745be792",dynamic:[b()],children:".modal-overlay.__jsx-style-dynamic-selector{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;z-index:10000}.modal-content.__jsx-style-dynamic-selector{background:#fff;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:0;max-width:450px;width:90%;-webkit-box-shadow:0 10px 40px rgba(0,0,0,.3);-moz-box-shadow:0 10px 40px rgba(0,0,0,.3);box-shadow:0 10px 40px rgba(0,0,0,.3);overflow:hidden}.modal-header.__jsx-style-dynamic-selector{background:".concat(b(),";padding:20px 25px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:12px}.modal-icon.__jsx-style-dynamic-selector{width:32px;height:32px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;font-size:24px}.modal-title.__jsx-style-dynamic-selector{font-size:18px;font-weight:600;color:#1a1a1a;margin:0}.modal-body.__jsx-style-dynamic-selector{padding:25px}.modal-message.__jsx-style-dynamic-selector{font-size:15px;color:#444;line-height:1.6;margin:0;white-space:pre-line}.modal-footer.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;gap:12px;padding:20px 25px;border-top:1px solid#e0e0e0;background:#f8f9fa}.modal-btn.__jsx-style-dynamic-selector{padding:10px 24px;font-size:14px;font-weight:600;border:none;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.modal-btn.__jsx-style-dynamic-selector:disabled{opacity:.6;cursor:not-allowed}.modal-btn-cancel.__jsx-style-dynamic-selector{background:#e0e0e0;color:#333}.modal-btn-cancel.__jsx-style-dynamic-selector:hover:not(:disabled){background:#d0d0d0}.modal-btn-confirm.__jsx-style-dynamic-selector{background:#06c;color:white}.modal-btn-confirm.__jsx-style-dynamic-selector:hover:not(:disabled){background:#0052a3}.modal-btn-confirm.warning.__jsx-style-dynamic-selector{background:#dc3545}.modal-btn-confirm.warning.__jsx-style-dynamic-selector:hover:not(:disabled){background:#c82333}.modal-btn-confirm.success.__jsx-style-dynamic-selector{background:#28a745}.modal-btn-confirm.success.__jsx-style-dynamic-selector:hover:not(:disabled){background:#1e7e34}.loading-spinner.__jsx-style-dynamic-selector{display:inline-block;width:14px;height:14px;border:2px solid#fff;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;border-top-color:transparent;-webkit-animation:spin.8s linear infinite;-moz-animation:spin.8s linear infinite;-o-animation:spin.8s linear infinite;animation:spin.8s linear infinite;margin-right:8px}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}")}),(0,i.jsxs)("div",{onClick:e=>e.stopPropagation(),className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-content",children:[(0,i.jsxs)("div",{className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-header",children:[(0,i.jsxs)("div",{className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-icon",children:["warning"===d&&"⚠️","success"===d&&"✅","info"===d&&"ℹ️"]}),(0,i.jsx)("h3",{className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-title",children:r})]}),(0,i.jsx)("div",{className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-body",children:(0,i.jsx)("p",{className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-message",children:s})}),(0,i.jsxs)("div",{className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-footer",children:[(0,i.jsx)("button",{onClick:n,disabled:m,className:o().dynamic([["2f014c33745be792",[b()]]])+" modal-btn modal-btn-cancel",children:l}),(0,i.jsxs)("button",{onClick:a,disabled:m,className:o().dynamic([["2f014c33745be792",[b()]]])+" "+"modal-btn modal-btn-confirm ".concat(d),children:[m&&(0,i.jsx)("span",{className:o().dynamic([["2f014c33745be792",[b()]]])+" loading-spinner"}),c]})]})]})]})}function s(e){let{isOpen:t,onClose:n,errors:a,getSectionDisplayName:r}=e;return t?(0,i.jsxs)("div",{onClick:n,className:"jsx-9370299e019b9ab5 modal-overlay",children:[(0,i.jsx)(o(),{id:"9370299e019b9ab5",children:".modal-overlay.jsx-9370299e019b9ab5{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;z-index:10000}.modal-content.jsx-9370299e019b9ab5{background:#fff;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:0;max-width:550px;width:90%;max-height:80vh;-webkit-box-shadow:0 10px 40px rgba(0,0,0,.3);-moz-box-shadow:0 10px 40px rgba(0,0,0,.3);box-shadow:0 10px 40px rgba(0,0,0,.3);overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.modal-header.jsx-9370299e019b9ab5{background:#dc3545;padding:20px 25px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:12px}.modal-icon.jsx-9370299e019b9ab5{font-size:28px}.modal-title.jsx-9370299e019b9ab5{font-size:18px;font-weight:600;color:#fff;margin:0}.modal-body.jsx-9370299e019b9ab5{padding:20px 25px;overflow-y:auto;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}.modal-intro.jsx-9370299e019b9ab5{font-size:14px;color:#666;margin-bottom:20px}.error-section.jsx-9370299e019b9ab5{margin-bottom:20px}.error-section-title.jsx-9370299e019b9ab5{font-size:15px;font-weight:600;color:#1a3a5c;margin-bottom:8px;padding-bottom:5px;border-bottom:2px solid#e0e0e0}.error-list.jsx-9370299e019b9ab5{list-style:none;padding:0;margin:0}.error-item.jsx-9370299e019b9ab5{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;padding:8px 0;font-size:14px;color:#c0392b}.error-bullet.jsx-9370299e019b9ab5{color:#dc3545;font-size:10px}.modal-footer.jsx-9370299e019b9ab5{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:20px 25px;border-top:1px solid#e0e0e0;background:#f8f9fa}.modal-btn-ok.jsx-9370299e019b9ab5{padding:12px 40px;font-size:15px;font-weight:600;background:#06c;color:white;border:none;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.modal-btn-ok.jsx-9370299e019b9ab5:hover{background:#0052a3}"}),(0,i.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"jsx-9370299e019b9ab5 modal-content",children:[(0,i.jsxs)("div",{className:"jsx-9370299e019b9ab5 modal-header",children:[(0,i.jsx)("span",{className:"jsx-9370299e019b9ab5 modal-icon",children:"❌"}),(0,i.jsx)("h3",{className:"jsx-9370299e019b9ab5 modal-title",children:"Cannot Submit ePRF"})]}),(0,i.jsxs)("div",{className:"jsx-9370299e019b9ab5 modal-body",children:[(0,i.jsx)("p",{className:"jsx-9370299e019b9ab5 modal-intro",children:"Please complete all required fields before submitting. The following sections have missing information:"}),Object.entries(a).map(e=>{let[t,n]=e;return(0,i.jsxs)("div",{className:"jsx-9370299e019b9ab5 error-section",children:[(0,i.jsx)("div",{className:"jsx-9370299e019b9ab5 error-section-title",children:r(t)}),(0,i.jsx)("ul",{className:"jsx-9370299e019b9ab5 error-list",children:n.map((e,t)=>(0,i.jsxs)("li",{className:"jsx-9370299e019b9ab5 error-item",children:[(0,i.jsx)("span",{className:"jsx-9370299e019b9ab5 error-bullet",children:"●"}),e]},t))})]},t)})]}),(0,i.jsx)("div",{className:"jsx-9370299e019b9ab5 modal-footer",children:(0,i.jsx)("button",{onClick:n,className:"jsx-9370299e019b9ab5 modal-btn-ok",children:"OK, I'll fix these"})})]})]}):null}function c(e){let{isOpen:t,onClose:n,title:a,message:r}=e;return t?(0,i.jsxs)("div",{onClick:n,className:"jsx-220c97c74d236b8a modal-overlay",children:[(0,i.jsx)(o(),{id:"220c97c74d236b8a",children:".modal-overlay.jsx-220c97c74d236b8a{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;z-index:10000}.modal-content.jsx-220c97c74d236b8a{background:#fff;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:0;max-width:450px;width:90%;-webkit-box-shadow:0 10px 40px rgba(0,0,0,.3);-moz-box-shadow:0 10px 40px rgba(0,0,0,.3);box-shadow:0 10px 40px rgba(0,0,0,.3);overflow:hidden;text-align:center}.modal-header.jsx-220c97c74d236b8a{background:#28a745;padding:30px 25px}.modal-icon.jsx-220c97c74d236b8a{font-size:60px;display:block;margin-bottom:10px}.modal-title.jsx-220c97c74d236b8a{font-size:22px;font-weight:600;color:#fff;margin:0}.modal-body.jsx-220c97c74d236b8a{padding:25px}.modal-message.jsx-220c97c74d236b8a{font-size:15px;color:#444;line-height:1.6;margin:0;white-space:pre-line}.modal-footer.jsx-220c97c74d236b8a{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:20px 25px;border-top:1px solid#e0e0e0;background:#f8f9fa}.modal-btn-ok.jsx-220c97c74d236b8a{padding:12px 50px;font-size:15px;font-weight:600;background:#28a745;color:white;border:none;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.modal-btn-ok.jsx-220c97c74d236b8a:hover{background:#1e7e34}"}),(0,i.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"jsx-220c97c74d236b8a modal-content",children:[(0,i.jsxs)("div",{className:"jsx-220c97c74d236b8a modal-header",children:[(0,i.jsx)("span",{className:"jsx-220c97c74d236b8a modal-icon",children:"✓"}),(0,i.jsx)("h3",{className:"jsx-220c97c74d236b8a modal-title",children:a})]}),(0,i.jsx)("div",{className:"jsx-220c97c74d236b8a modal-body",children:(0,i.jsx)("p",{className:"jsx-220c97c74d236b8a modal-message",children:r})}),(0,i.jsx)("div",{className:"jsx-220c97c74d236b8a modal-footer",children:(0,i.jsx)("button",{onClick:n,className:"jsx-220c97c74d236b8a modal-btn-ok",children:"Done"})})]})]}):null}},1028:function(e,t,n){async function i(e,t,n,i,a){try{let o=await fetch("/api/eprf/records",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({incidentId:e,patientLetter:t,authorDiscordId:n,authorCallsign:i,fleetId:a})}),r=await o.json();if(r.success)return r.record;return console.error("createEPRFRecord error:",r.error),null}catch(e){return console.error("createEPRFRecord error:",e),null}}async function a(e){try{let t=new URLSearchParams({discordId:e}),n=await fetch("/api/eprf/records?".concat(t)),i=await n.json();return i.success?i.records:[]}catch(e){return console.error("getEPRFRecordsByUser error:",e),[]}}async function o(e,t,n){try{let i=new URLSearchParams({discordId:e});t&&i.set("query",t),n&&i.set("status",n);let a=await fetch("/api/eprf/records?".concat(i)),o=await a.json();return o.success?o.records:[]}catch(e){return console.error("searchEPRFs error:",e),[]}}async function r(e,t){try{let n=await fetch("/api/eprf/records",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({incidentId:e,patientLetter:t,action:"complete"})}),i=await n.json();return i.success?i.record:null}catch(e){return console.error("markEPRFComplete error:",e),null}}async function s(e,t,n,i){try{let a=await fetch("/api/eprf/records",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({incidentId:e,patientLetter:t,action:"transfer",newAuthorDiscordId:n,newAuthorCallsign:i})}),o=await a.json();return o.success?o.record:null}catch(e){return console.error("transferEPRF error:",e),null}}async function c(e,t){try{let n=await fetch("/api/eprf/records",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({incidentId:e,patientLetter:t})});return(await n.json()).success}catch(e){return console.error("deleteEPRFRecord error:",e),!1}}async function l(e,t){try{let n=new URLSearchParams({incidentId:e,patientLetter:t,all:"true"}),i=await fetch("/api/eprf/data?".concat(n)),a=await i.json();return a.success?a.data:{}}catch(e){return console.error("getAllEPRFData error:",e),{}}}async function d(){try{let e=await fetch("/api/users?active=true"),t=await e.json();return t.success?t.users:[]}catch(e){return console.error("getActiveUsers error:",e),[]}}function m(e){return"695765253612953651"===e}async function b(e,t,n,i){try{let a=new URLSearchParams({discordId:e});t&&a.set("query",t),n&&a.set("status",n),i&&a.set("authorId",i);let o=await fetch("/api/admin/records?".concat(a)),r=await o.json();return r.success?r.records:[]}catch(e){return console.error("adminGetAllRecords error:",e),[]}}async function x(e){try{let t=new URLSearchParams({discordId:e,type:"users"}),n=await fetch("/api/admin/records?".concat(t)),i=await n.json();return i.success?i.users:[]}catch(e){return console.error("adminGetAllUsers error:",e),[]}}async function p(e,t,n){try{let i=await fetch("/api/admin/records",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({discordId:e,incidentId:t,patientLetter:n})});return(await i.json()).success}catch(e){return console.error("adminDeleteRecord error:",e),!1}}async function f(e,t,n,i,a){try{let o=await fetch("/api/admin/records",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({discordId:e,incidentId:t,patientLetter:n,action:"transfer",newAuthorDiscordId:i,newAuthorCallsign:a})}),r=await o.json();return r.success?r.record:null}catch(e){return console.error("adminTransferRecord error:",e),null}}n.d(t,{$h:function(){return r},Ee:function(){return x},F3:function(){return s},GJ:function(){return m},Gx:function(){return f},HX:function(){return c},Jf:function(){return a},bW:function(){return b},cO:function(){return d},ie:function(){return i},qx:function(){return o},uK:function(){return p},wK:function(){return l}})},3291:function(e,t,n){n.d(t,{NI:function(){return s},kv:function(){return c}});var i=n(3375);function a(e,t,n){return e.setFillColor(0,82,147),e.rect(10,n,190,8,"F"),e.setTextColor(255,255,255),e.setFontSize(11),e.setFont("helvetica","bold"),e.text(t,15,n+6),e.setTextColor(0,0,0),e.setFont("helvetica","normal"),n+12}function o(e,t,n,i,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:90;e.setFontSize(8),e.setFont("helvetica","bold"),e.text(t+":",i,a),e.setFont("helvetica","normal");let r=e.splitTextToSize(n||"N/A",o-5);return e.text(r,i,a+4),a+4+3.5*r.length}function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;return t+n>280?(e.addPage(),20):t}function s(e){(function(e){let t=new i.kH,n=15;t.setFillColor(0,51,102),t.rect(0,0,210,25,"F"),t.setTextColor(255,255,255),t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Electronic Patient Report Form (ePRF)",105,12,{align:"center"}),t.setFontSize(10),t.text("Incident ID: ".concat(e.incidentId," | Patient: ").concat(e.patientLetter),105,20,{align:"center"}),t.setTextColor(0,0,0),n=a(t,"Incident Information",n=35);let s=e.incident||{};t.setFontSize(9),n=o(t,"Case Type",s.caseType,15,n),n=o(t,"Date/Time of Call",function(e){if(!e)return"N/A";try{return new Date(e).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}}(s.dateTimeOfCall),15,n),n=o(t,"Incident Location",s.incidentLocation,15,n),n=o(t,"Location Type",s.locationType,15,n),s.chiefComplaint&&(n=o(t,"Chief Complaint",s.chiefComplaint,15,n)),n+=5,n=r(t,n,50),n=a(t,"Patient Information",n);let c=e.patientInfo||{},l=n,d=n;l=o(t,"Roblox Username",c.robloxUsername,15,l),d=o(t,"NHS Number",c.nhsNo,110,d),l=o(t,"First Name",c.firstName,15,l),d=o(t,"Surname",c.surname,110,d),l=o(t,"Sex",c.sex,15,l),d=o(t,"Date of Birth",c.dob,110,d),n=Math.max(l=o(t,"Age","".concat(c.age||""," ").concat(c.ageType||"").trim(),15,l),d=o(t,"Weight",c.weight?"".concat(c.weight," kg"):"",110,d)),n=o(t,"Patient Address",c.ptAddress,15,n,180)+5,n=r(t,n,50),n=a(t,"Primary Survey",n);let m=e.primarySurvey||{};l=n,d=n,l=o(t,"Clinical Status",m.clinicalStatus,15,l),d=o(t,"Responsiveness",m.responsiveness,110,d),l=o(t,"Airway",m.airway,15,l),d=o(t,"Breathing",m.breathing,110,d),l=o(t,"Circulation",m.circulation,15,l),d=o(t,"Blood Loss",m.bloodLoss,110,d),m.traumaType?(n=Math.max(l,d),n=o(t,"Trauma Type",m.traumaType,15,n)):n=Math.max(l,d),n+=5,n=r(t,n,40),n=a(t,"Presenting Complaint & History",n);let b=e.hxComplaint||{};n=o(t,"Presenting Complaint(s)",Array.isArray(b.complaints)?b.complaints.join(", "):b.complaints,15,n,180),n=o(t,"Date of Onset",b.dateOfOnset,15,n),b.symptoms&&(n=o(t,"Symptoms",b.symptoms,15,n,180)),b.patientNarrative&&(n=o(t,"Patient Narrative",b.patientNarrative,15,n,180)),n+=5,n=r(t,n,40),n=a(t,"Past Medical History",n);let x=e.pastMedicalHistory||{};if(n=o(t,"Past Medical History",x.pastMedicalHistory,15,n,180),n=o(t,"Medications",x.medications,15,n,180),n=o(t,"Allergies",x.allergies,15,n,180),n=o(t,"Last Oral Intake",x.lastOralIntake,15,n,180)+5,n=r(t,n,50),e.vitals&&e.vitals.length>0){n=a(t,"Vital Observations",n),t.setFontSize(7),t.setFont("helvetica","bold");let i=[30,20,30,20,20,20,20,20],o=15;["Time","HR","BP","SpO2","RR","Temp","GCS","Pain"].forEach((e,a)=>{t.text(e,o,n),o+=i[a]}),n+=4,t.setFont("helvetica","normal"),e.vitals.forEach(e=>{n=r(t,n,8),o=15,[e.time||"",e.heartRate||"",e.bloodPressure||"",e.spo2||"",e.respRate||"",e.temp||"",e.gcsTotal||"",e.painScore||""].forEach((e,a)=>{t.text(String(e),o,n),o+=i[a]}),n+=4}),n+=5}if(n=r(t,n,50),e.medications&&e.medications.length>0){n=a(t,"Medications Administered",n),t.setFontSize(7),t.setFont("helvetica","bold");let i=[30,50,30,30,40],o=15;["Time","Medication","Dose","Route","Admin By"].forEach((e,a)=>{t.text(e,o,n),o+=i[a]}),n+=4,t.setFont("helvetica","normal"),e.medications.forEach(e=>{n=r(t,n,8),o=15,[e.time||"",e.medication||"","".concat(e.dose||""," ").concat(e.unit||"").trim(),e.route||"",e.administeredBy||""].forEach((e,a)=>{let r=t.splitTextToSize(String(e),i[a]-2)[0];t.text(r,o,n),o+=i[a]}),n+=4}),n+=5}n=r(t,n,50),e.interventions&&e.interventions.length>0&&(n=a(t,"Interventions",n),e.interventions.forEach((e,i)=>{n=r(t,n,20),t.setFontSize(8),t.setFont("helvetica","bold"),t.text("Intervention ".concat(i+1,": ").concat(e.time||""," by ").concat(e.performedBy||""),15,n),n+=5,t.setFont("helvetica","normal");let a=[];if(e.airway&&a.push("Airway: ".concat(e.airway)),e.ventilation&&a.push("Ventilation: ".concat(e.ventilation)),e.cpr&&a.push("CPR: ".concat(e.cpr)),e.defibrillation&&a.push("Defibrillation: ".concat(e.defibrillation)),e.ivCannulation&&a.push("IV: ".concat(e.ivCannulation)),e.ioAccess&&a.push("IO: ".concat(e.ioAccess)),a.length>0){let e=a.join(" | "),i=t.splitTextToSize(e,180);t.text(i,15,n),n+=4*i.length}n+=3}),n+=5),n=r(t,n,40),n=a(t,"Clinical Impression",n);let p=e.clinicalImpression||{};n=o(t,"Primary Clinical Impression",p.primaryClinicalImpression,15,n,180),p.secondaryClinicalImpression&&(n=o(t,"Secondary Clinical Impression",p.secondaryClinicalImpression,15,n,180)),p.clinicalNotes&&(n=o(t,"Clinical Notes",p.clinicalNotes,15,n,180)),n+=5,n=r(t,n,40),n=a(t,"Disposition",n);let f=e.disposition||{};l=n,d=n,n=Math.max(l=o(t,"Disposition",f.disposition,15,l),d=o(t,"Final Patient Status",f.finalPatientStatus,110,d)),n=o(t,"Copy to GP",f.copyToGP,15,n),f.receivingFacility&&(n=o(t,"Receiving Facility",f.receivingFacility,15,n)),f.handoverTo&&(n=o(t,"Handover To",f.handoverTo,15,n));let u=t.getNumberOfPages();for(let n=1;n<=u;n++)t.setPage(n),t.setFontSize(8),t.setTextColor(128,128,128),t.text("Page ".concat(n," of ").concat(u),105,290,{align:"center"}),t.text("Generated: ".concat(new Date().toLocaleString("en-GB")),15,290),t.text("ePRF ID: ".concat(e.incidentId,"-").concat(e.patientLetter),195,290,{align:"right"});return t})(e).save("ePRF_".concat(e.incidentId,"_Patient").concat(e.patientLetter,"_").concat(new Date().toISOString().split("T")[0],".pdf"))}function c(e,t){let n=e=>{try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(e){return null}};return{incidentId:e,patientLetter:t,incident:n("incident_".concat(e)),patientInfo:n("patient_info_".concat(e)),primarySurvey:n("primary_survey_".concat(e)),hxComplaint:n("hx_complaint_".concat(e)),pastMedicalHistory:n("past_medical_history_".concat(e)),clinicalImpression:n("clinical_impression_".concat(e)),disposition:n("disposition_".concat(e)),vitals:n("vitals_".concat(e))||[],medications:n("medications_".concat(e))||[],interventions:n("interventions_".concat(e))||[]}}},8029:function(e,t,n){function i(){try{let e=localStorage.getItem("logged_in_users");if(!e)return[];let t=JSON.parse(e),n=new Date().getTime();return t.filter(e=>{let t=new Date(e.loginTime).getTime();return n-t<864e5})}catch(e){return[]}}function a(){try{let e=localStorage.getItem("current_user");return e?JSON.parse(e):null}catch(e){return null}}function o(){let e=a();return e?i().filter(t=>t.discordId!==e.discordId):i()}n.d(t,{Cn:function(){return o},ts:function(){return a}})}}]);